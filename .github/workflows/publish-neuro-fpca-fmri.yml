name: Publish Neuro-fPCA-fMRI to PyPI

on:
  push:
    branches:
      - main

jobs:
  publish:
    runs-on: ubuntu-latest

    steps:
    - name: Check out the code
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install setuptools build twine

    # ADDED: This step will show you the file structure in the logs
    # so you can confirm where pyproject.toml is located.
    - name: Debug - List files
      run: ls -R

    - name: Build and publish
      # IMPORTANT: If pyproject.toml is in a subfolder, uncomment the line below
      # and replace './your-subfolder-name' with the actual folder name.
      # working-directory: ./path/to/folder/containing/pyproject_toml
      env:
        TWINE_USERNAME: __token__
        TWINE_PASSWORD: ${{ secrets.PYPI_API_TOKEN }}
      run: |
        python -m build
        twine upload dist/* --verbose
